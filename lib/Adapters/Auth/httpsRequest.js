"use strict";

const https = require('https');

function makeCallback(resolve, reject, noJSON) {
  return function (res) {
    let data = '';
    res.on('data', chunk => {
      data += chunk;
    });
    res.on('end', () => {
      if (noJSON) {
        return resolve(data);
      }

      try {
        data = JSON.parse(data);
      } catch (e) {
        return reject(e);
      }

      resolve(data);
    });
    res.on('error', reject);
  };
}

function get(options, noJSON = false) {
  return new Promise((resolve, reject) => {
    https.get(options, makeCallback(resolve, reject, noJSON)).on('error', reject);
  });
}

function request(options, postData) {
  return new Promise((resolve, reject) => {
    const req = https.request(options, makeCallback(resolve, reject));
    req.on('error', reject);
    req.write(postData);
    req.end();
  });
}

module.exports = {
  get,
  request
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJodHRwcyIsInJlcXVpcmUiLCJtYWtlQ2FsbGJhY2siLCJyZXNvbHZlIiwicmVqZWN0Iiwibm9KU09OIiwicmVzIiwiZGF0YSIsIm9uIiwiY2h1bmsiLCJKU09OIiwicGFyc2UiLCJlIiwiZ2V0Iiwib3B0aW9ucyIsIlByb21pc2UiLCJyZXF1ZXN0IiwicG9zdERhdGEiLCJyZXEiLCJ3cml0ZSIsImVuZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvQWRhcHRlcnMvQXV0aC9odHRwc1JlcXVlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaHR0cHMgPSByZXF1aXJlKCdodHRwcycpO1xuXG5mdW5jdGlvbiBtYWtlQ2FsbGJhY2socmVzb2x2ZSwgcmVqZWN0LCBub0pTT04pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChyZXMpIHtcbiAgICBsZXQgZGF0YSA9ICcnO1xuICAgIHJlcy5vbignZGF0YScsIGNodW5rID0+IHtcbiAgICAgIGRhdGEgKz0gY2h1bms7XG4gICAgfSk7XG4gICAgcmVzLm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICBpZiAobm9KU09OKSB7XG4gICAgICAgIHJldHVybiByZXNvbHZlKGRhdGEpO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiByZWplY3QoZSk7XG4gICAgICB9XG4gICAgICByZXNvbHZlKGRhdGEpO1xuICAgIH0pO1xuICAgIHJlcy5vbignZXJyb3InLCByZWplY3QpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBnZXQob3B0aW9ucywgbm9KU09OID0gZmFsc2UpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBodHRwcy5nZXQob3B0aW9ucywgbWFrZUNhbGxiYWNrKHJlc29sdmUsIHJlamVjdCwgbm9KU09OKSkub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlcXVlc3Qob3B0aW9ucywgcG9zdERhdGEpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCByZXEgPSBodHRwcy5yZXF1ZXN0KG9wdGlvbnMsIG1ha2VDYWxsYmFjayhyZXNvbHZlLCByZWplY3QpKTtcbiAgICByZXEub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgICByZXEud3JpdGUocG9zdERhdGEpO1xuICAgIHJlcS5lbmQoKTtcbiAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0geyBnZXQsIHJlcXVlc3QgfTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxLQUFLLEdBQUdDLE9BQU8sQ0FBQyxPQUFELENBQXJCOztBQUVBLFNBQVNDLFlBQVQsQ0FBc0JDLE9BQXRCLEVBQStCQyxNQUEvQixFQUF1Q0MsTUFBdkMsRUFBK0M7RUFDN0MsT0FBTyxVQUFVQyxHQUFWLEVBQWU7SUFDcEIsSUFBSUMsSUFBSSxHQUFHLEVBQVg7SUFDQUQsR0FBRyxDQUFDRSxFQUFKLENBQU8sTUFBUCxFQUFlQyxLQUFLLElBQUk7TUFDdEJGLElBQUksSUFBSUUsS0FBUjtJQUNELENBRkQ7SUFHQUgsR0FBRyxDQUFDRSxFQUFKLENBQU8sS0FBUCxFQUFjLE1BQU07TUFDbEIsSUFBSUgsTUFBSixFQUFZO1FBQ1YsT0FBT0YsT0FBTyxDQUFDSSxJQUFELENBQWQ7TUFDRDs7TUFDRCxJQUFJO1FBQ0ZBLElBQUksR0FBR0csSUFBSSxDQUFDQyxLQUFMLENBQVdKLElBQVgsQ0FBUDtNQUNELENBRkQsQ0FFRSxPQUFPSyxDQUFQLEVBQVU7UUFDVixPQUFPUixNQUFNLENBQUNRLENBQUQsQ0FBYjtNQUNEOztNQUNEVCxPQUFPLENBQUNJLElBQUQsQ0FBUDtJQUNELENBVkQ7SUFXQUQsR0FBRyxDQUFDRSxFQUFKLENBQU8sT0FBUCxFQUFnQkosTUFBaEI7RUFDRCxDQWpCRDtBQWtCRDs7QUFFRCxTQUFTUyxHQUFULENBQWFDLE9BQWIsRUFBc0JULE1BQU0sR0FBRyxLQUEvQixFQUFzQztFQUNwQyxPQUFPLElBQUlVLE9BQUosQ0FBWSxDQUFDWixPQUFELEVBQVVDLE1BQVYsS0FBcUI7SUFDdENKLEtBQUssQ0FBQ2EsR0FBTixDQUFVQyxPQUFWLEVBQW1CWixZQUFZLENBQUNDLE9BQUQsRUFBVUMsTUFBVixFQUFrQkMsTUFBbEIsQ0FBL0IsRUFBMERHLEVBQTFELENBQTZELE9BQTdELEVBQXNFSixNQUF0RTtFQUNELENBRk0sQ0FBUDtBQUdEOztBQUVELFNBQVNZLE9BQVQsQ0FBaUJGLE9BQWpCLEVBQTBCRyxRQUExQixFQUFvQztFQUNsQyxPQUFPLElBQUlGLE9BQUosQ0FBWSxDQUFDWixPQUFELEVBQVVDLE1BQVYsS0FBcUI7SUFDdEMsTUFBTWMsR0FBRyxHQUFHbEIsS0FBSyxDQUFDZ0IsT0FBTixDQUFjRixPQUFkLEVBQXVCWixZQUFZLENBQUNDLE9BQUQsRUFBVUMsTUFBVixDQUFuQyxDQUFaO0lBQ0FjLEdBQUcsQ0FBQ1YsRUFBSixDQUFPLE9BQVAsRUFBZ0JKLE1BQWhCO0lBQ0FjLEdBQUcsQ0FBQ0MsS0FBSixDQUFVRixRQUFWO0lBQ0FDLEdBQUcsQ0FBQ0UsR0FBSjtFQUNELENBTE0sQ0FBUDtBQU1EOztBQUVEQyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7RUFBRVQsR0FBRjtFQUFPRztBQUFQLENBQWpCIn0=